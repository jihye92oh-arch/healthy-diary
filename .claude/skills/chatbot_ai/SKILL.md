# AI ì±—ë´‡ ê¸°ëŠ¥ êµ¬í˜„ ê°€ì´ë“œ (Healthy Diary)

## ğŸ“‹ ê°œìš”

Healthy Diary ì•±ì— í†µí•©ë  AI ê±´ê°• ì–´ì‹œìŠ¤í„´íŠ¸ ì±—ë´‡ì˜ êµ¬í˜„ ê°€ì´ë“œì…ë‹ˆë‹¤. ì‚¬ìš©ìì˜ ì‹ë‹¨, ìš´ë™, ê±´ê°• ê´€ë ¨ ì§ˆë¬¸ì— ë‹µí•˜ê³  ê°œì¸í™”ëœ ì¡°ì–¸ì„ ì œê³µí•©ë‹ˆë‹¤.

---

## ğŸ¯ ì±—ë´‡ í•µì‹¬ ê¸°ëŠ¥

### 1. ëŒ€í™”í˜• ê±´ê°• ìƒë‹´
- ì‹ë‹¨ ê´€ë ¨ ì§ˆë¬¸ ì‘ë‹µ
- ìš´ë™ ì¶”ì²œ ë° ì¡°ì–¸
- ì¹¼ë¡œë¦¬ ê³„ì‚° ë„ì›€
- ì˜ì–‘ì†Œ ì •ë³´ ì œê³µ
- ê±´ê°• ê´€ë ¨ ì¼ë°˜ ìƒë‹´

### 2. ë°ì´í„° ê¸°ë°˜ ê°œì¸í™”
- ì‚¬ìš©ìì˜ ê¸°ë¡ ë°ì´í„° ë¶„ì„
- ëª©í‘œ ëŒ€ë¹„ ì§„í–‰ ìƒí™© íŒŒì•…
- ë§ì¶¤í˜• ì¡°ì–¸ ìƒì„±
- íŒ¨í„´ ë¶„ì„ ë° í”¼ë“œë°±

### 3. ë¹ ë¥¸ ì‘ì—… ìˆ˜í–‰
- ìŒì„±/í…ìŠ¤íŠ¸ ëª…ë ¹ìœ¼ë¡œ ê¸°ë¡ ì¶”ê°€
- ì •ë³´ ì¡°íšŒ ë° ê²€ìƒ‰
- ë¦¬ë§ˆì¸ë” ì„¤ì •
- ë¦¬í¬íŠ¸ ìš”ì²­

---

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ ì„¤ê³„

### ì‹œìŠ¤í…œ êµ¬ì¡°
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ (GUI)              â”‚
â”‚                 ì±„íŒ… ìœˆë„ìš°                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            ì±—ë´‡ ë§¤ë‹ˆì € (Chatbot Manager)         â”‚
â”‚  - ì…ë ¥ ì „ì²˜ë¦¬                                   â”‚
â”‚  - ì˜ë„ ë¶„ë¥˜ (Intent Classification)            â”‚
â”‚  - ì»¨í…ìŠ¤íŠ¸ ê´€ë¦¬                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   AI ì—”ì§„         â”‚ â”‚  ë°ì´í„° ì»¤ë„¥í„°           â”‚
â”‚  - LLM API        â”‚ â”‚  - ì‚¬ìš©ì DB            â”‚
â”‚  - ë¡œì»¬ ëª¨ë¸      â”‚ â”‚  - ì‹í’ˆ DB              â”‚
â”‚  - ê·œì¹™ ê¸°ë°˜      â”‚ â”‚  - ìš´ë™ DB              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ì‘ë‹µ ìƒì„± & ì•¡ì…˜ ì‹¤í–‰                â”‚
â”‚  - í…ìŠ¤íŠ¸ ì‘ë‹µ                                   â”‚
â”‚  - UI ì•¡ì…˜ (ê¸°ë¡ ì¶”ê°€, ì°¨íŠ¸ í‘œì‹œ ë“±)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¬ GUI í†µí•© ì„¤ê³„

### ì±—ë´‡ íƒ­ ë ˆì´ì•„ì›ƒ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ  í™ˆ â”‚ ğŸ“ ê¸°ë¡ â”‚ ğŸ“Š ë¶„ì„ â”‚ ğŸ¯ ëª©í‘œ â”‚ ğŸ’¡ ì¶”ì²œ â”‚ ğŸ¤– AI â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ì±„íŒ… íˆìŠ¤í† ë¦¬                              â”‚ â”‚
â”‚  â”‚                                             â”‚ â”‚
â”‚  â”‚  ğŸ¤–: ì•ˆë…•í•˜ì„¸ìš”! ê±´ê°• ê´€ë¦¬ë¥¼ ë„ì™€ë“œë¦´      â”‚ â”‚
â”‚  â”‚      AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.                  â”‚ â”‚
â”‚  â”‚                                             â”‚ â”‚
â”‚  â”‚  ğŸ‘¤: ì˜¤ëŠ˜ ì ì‹¬ìœ¼ë¡œ ë­ ë¨¹ìœ¼ë©´ ì¢‹ì„ê¹Œ?       â”‚ â”‚
â”‚  â”‚                                             â”‚ â”‚
â”‚  â”‚  ğŸ¤–: í˜„ì¬ ì„­ì·¨ ì¹¼ë¡œë¦¬ê°€ 800kcalì´ë¯€ë¡œ      â”‚ â”‚
â”‚  â”‚      ì ì‹¬ì€ 600kcal ì •ë„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.     â”‚ â”‚
â”‚  â”‚      ê³„ì ˆ ë©”ë‰´ë¡œ ë´„ë‚˜ë¬¼ ë¹„ë¹”ë°¥ ì–´ë– ì„¸ìš”?   â”‚ â”‚
â”‚  â”‚      [ë ˆì‹œí”¼ ë³´ê¸°] [ì‹ë‹¨ì— ì¶”ê°€]           â”‚ â”‚
â”‚  â”‚                                             â”‚ â”‚
â”‚  â”‚  ğŸ‘¤: ì¢‹ì•„, ì¶”ê°€í•´ì¤˜                        â”‚ â”‚
â”‚  â”‚                                             â”‚ â”‚
â”‚  â”‚  ğŸ¤–: âœ… ì ì‹¬ ì‹ë‹¨ì— ë´„ë‚˜ë¬¼ ë¹„ë¹”ë°¥(550kcal) â”‚ â”‚
â”‚  â”‚      ì¶”ê°€í–ˆìŠµë‹ˆë‹¤!                         â”‚ â”‚
â”‚  â”‚                                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ğŸ’¬ ë©”ì‹œì§€ ì…ë ¥...             [ğŸ¤] [ğŸ“]  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                  â”‚
â”‚  ë¹ ë¥¸ ì§ˆë¬¸:                                      â”‚
â”‚  [ì˜¤ëŠ˜ ë­ ë¨¹ì„ê¹Œ?] [ìš´ë™ ì¶”ì²œí•´ì¤˜]              â”‚
â”‚  [ëª©í‘œ ì§„í–‰ë¥ ì€?] [ë¬¼ ë§ˆì‹œê¸° ì•Œë ¤ì¤˜]            â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í”Œë¡œíŒ… ì±—ë´‡ ë²„íŠ¼ (ëª¨ë“  íƒ­ì—ì„œ ì ‘ê·¼)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                          â”‚
â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        ë©”ì¸ ì»¨í…ì¸         â”‚   ë¹ ë¥¸     â”‚ â”‚
â”‚                          â”‚   ğŸ’¬        â”‚ â”‚
â”‚                          â”‚   [ì±„íŒ…]   â”‚ â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

í´ë¦­ ì‹œ â†’ ì±„íŒ… íŒì—… ë˜ëŠ” ì±—ë´‡ íƒ­ìœ¼ë¡œ ì´ë™
```

---

## ğŸ§  AI ì—”ì§„ ì„ íƒ ê°€ì´ë“œ

### Option 1: í´ë¼ìš°ë“œ LLM API (ì¶”ì²œ)

#### ì¥ì 
- ê°•ë ¥í•œ ìì—°ì–´ ì´í•´ ëŠ¥ë ¥
- ì§€ì†ì ì¸ ëª¨ë¸ ì—…ë°ì´íŠ¸
- ë¹ ë¥¸ êµ¬í˜„

#### ë‹¨ì 
- API ë¹„ìš© ë°œìƒ
- ì¸í„°ë„· ì—°ê²° í•„ìˆ˜
- ë°ì´í„° í”„ë¼ì´ë²„ì‹œ ê³ ë ¤ í•„ìš”

#### ì¶”ì²œ ì„œë¹„ìŠ¤
**OpenAI GPT API**
```python
import openai

def get_ai_response(user_message, context):
    response = openai.ChatCompletion.create(
        model="gpt-4",
        messages=[
            {"role": "system", "content": SYSTEM_PROMPT},
            {"role": "user", "content": user_message}
        ],
        temperature=0.7,
        max_tokens=500
    )
    return response.choices[0].message.content
```

**Google Gemini API**
```python
import google.generativeai as genai

def get_ai_response(user_message, context):
    model = genai.GenerativeModel('gemini-pro')
    response = model.generate_content(
        f"{SYSTEM_PROMPT}\n\nì‚¬ìš©ì: {user_message}"
    )
    return response.text
```

**Anthropic Claude API**
```python
import anthropic

def get_ai_response(user_message, context):
    client = anthropic.Anthropic(api_key="your-api-key")
    message = client.messages.create(
        model="claude-3-sonnet-20240229",
        max_tokens=1024,
        messages=[
            {"role": "user", "content": user_message}
        ]
    )
    return message.content[0].text
```

### Option 2: ë¡œì»¬ LLM (í”„ë¼ì´ë²„ì‹œ ì¤‘ì‹œ)

#### ì¥ì 
- ì˜¤í”„ë¼ì¸ ì‘ë™
- ë¬´ë£Œ (API ë¹„ìš© ì—†ìŒ)
- ì™„ì „í•œ ë°ì´í„° í”„ë¼ì´ë²„ì‹œ

#### ë‹¨ì 
- ë†’ì€ ì»´í“¨íŒ… ë¦¬ì†ŒìŠ¤ í•„ìš”
- ì„±ëŠ¥ì´ í´ë¼ìš°ë“œ ëª¨ë¸ë³´ë‹¤ ë‚®ì„ ìˆ˜ ìˆìŒ
- ì´ˆê¸° ì„¤ì • ë³µì¡

#### ì¶”ì²œ ëª¨ë¸
**Ollama (ê°€ì¥ ì‰¬ìš´ ì„¤ì •)**
```python
import requests

def get_ai_response(user_message, context):
    response = requests.post(
        'http://localhost:11434/api/generate',
        json={
            'model': 'llama2',
            'prompt': f"{SYSTEM_PROMPT}\n\nì‚¬ìš©ì: {user_message}",
            'stream': False
        }
    )
    return response.json()['response']
```

**Hugging Face Transformers**
```python
from transformers import AutoModelForCausalLM, AutoTokenizer

model_name = "beomi/llama-2-ko-7b"
tokenizer = AutoTokenizer.from_pretrained(model_name)
model = AutoModelForCausalLM.from_pretrained(model_name)

def get_ai_response(user_message, context):
    inputs = tokenizer(user_message, return_tensors="pt")
    outputs = model.generate(**inputs, max_length=200)
    return tokenizer.decode(outputs[0])
```

### Option 3: í•˜ì´ë¸Œë¦¬ë“œ ë°©ì‹ (ê· í˜•)

```python
class HybridChatbot:
    def __init__(self):
        self.use_cloud = self.check_internet_connection()
        
    def get_response(self, user_message, context):
        # ì˜ë„ ë¶„ë¥˜
        intent = self.classify_intent(user_message)
        
        # ê°„ë‹¨í•œ ì˜ë„ëŠ” ê·œì¹™ ê¸°ë°˜ìœ¼ë¡œ ì²˜ë¦¬
        if intent in ['greeting', 'add_meal', 'add_exercise']:
            return self.rule_based_response(intent, user_message)
        
        # ë³µì¡í•œ ì§ˆë¬¸ì€ AIë¡œ ì²˜ë¦¬
        elif self.use_cloud:
            return self.cloud_ai_response(user_message, context)
        else:
            return self.local_ai_response(user_message, context)
```

---

## ğŸ“ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ì„¤ê³„

### ê¸°ë³¸ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸

```python
SYSTEM_PROMPT = """
ë‹¹ì‹ ì€ 'Healthy Diary' ì•±ì˜ AI ê±´ê°• ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.

## ì—­í• 
- ì‚¬ìš©ìì˜ ì‹ë‹¨, ìš´ë™, ê±´ê°• ê´€ë¦¬ë¥¼ ë•ëŠ” ì¹œì ˆí•œ ì¡°ë ¥ì
- ê³¼í•™ì ì´ê³  ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ê±´ê°• ì •ë³´ ì œê³µ
- ì‚¬ìš©ìì˜ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°œì¸í™”ëœ ì¡°ì–¸ ì œê³µ

## ê°€ì´ë“œë¼ì¸
1. í•­ìƒ ì¹œì ˆí•˜ê³  ê²©ë ¤í•˜ëŠ” í†¤ìœ¼ë¡œ ëŒ€í™”í•˜ì„¸ìš”
2. ì˜í•™ì  ì§„ë‹¨ì´ë‚˜ ì²˜ë°©ì€ í•˜ì§€ ë§ê³ , ì „ë¬¸ì˜ ìƒë‹´ì„ ê¶Œìœ í•˜ì„¸ìš”
3. ì‚¬ìš©ìì˜ ëª©í‘œì™€ í˜„ì¬ ìƒíƒœë¥¼ ê³ ë ¤í•œ ì¡°ì–¸ì„ í•˜ì„¸ìš”
4. êµ¬ì²´ì ì´ê³  ì‹¤í–‰ ê°€ëŠ¥í•œ íŒì„ ì œê³µí•˜ì„¸ìš”
5. ê°„ê²°í•˜ê²Œ ë‹µë³€í•˜ë˜, í•„ìš”ì‹œ ìƒì„¸ ì •ë³´ë¥¼ ì œê³µí•˜ì„¸ìš”

## ê°€ëŠ¥í•œ ì‘ì—…
- ì‹ë‹¨ ê¸°ë¡ ì¶”ê°€/ì¡°íšŒ
- ìš´ë™ ê¸°ë¡ ì¶”ê°€/ì¡°íšŒ
- ì¹¼ë¡œë¦¬ ê³„ì‚°
- ì˜ì–‘ì†Œ ì •ë³´ ì œê³µ
- ì‹ë‹¨/ìš´ë™ ì¶”ì²œ
- ëª©í‘œ ì§„í–‰ ìƒí™© í™•ì¸
- í†µê³„ ìš”ì•½ ì œê³µ

## ì‘ë‹µ í˜•ì‹
- ì¼ë°˜ ëŒ€í™”: ìì—°ìŠ¤ëŸ¬ìš´ í…ìŠ¤íŠ¸
- ì•¡ì…˜ í•„ìš”ì‹œ: JSON í˜•ì‹ìœ¼ë¡œ ì•¡ì…˜ ì •ë³´ í¬í•¨
  ì˜ˆ: {"action": "add_meal", "data": {...}, "message": "..."}

í˜„ì¬ ì‚¬ìš©ì ì •ë³´:
- ì´ë¦„: {user_name}
- ëª©í‘œ: {goal_weight}kg ë‹¬ì„±
- ì¼ì¼ ì¹¼ë¡œë¦¬ ëª©í‘œ: {daily_calorie_goal}kcal
- ì˜¤ëŠ˜ ì„­ì·¨: {today_calories_intake}kcal
- ì˜¤ëŠ˜ ì†Œëª¨: {today_calories_burned}kcal
"""
```

### ì»¨í…ìŠ¤íŠ¸ í¬í•¨ í”„ë¡¬í”„íŠ¸ ìƒì„±

```python
def create_context_prompt(user_data):
    """ì‚¬ìš©ì ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì»¨í…ìŠ¤íŠ¸ í”„ë¡¬í”„íŠ¸ ìƒì„±"""
    
    # ìµœê·¼ ì‹ë‹¨ ìš”ì•½
    recent_meals = get_recent_meals(user_data['user_id'], days=3)
    meals_summary = summarize_meals(recent_meals)
    
    # ìµœê·¼ ìš´ë™ ìš”ì•½
    recent_exercises = get_recent_exercises(user_data['user_id'], days=3)
    exercise_summary = summarize_exercises(recent_exercises)
    
    # ëª©í‘œ ì§„í–‰ë¥ 
    progress = calculate_progress(user_data['user_id'])
    
    context = f"""
## ìµœê·¼ 3ì¼ í™œë™ ìš”ì•½
### ì‹ë‹¨
{meals_summary}

### ìš´ë™
{exercise_summary}

### ëª©í‘œ ì§„í–‰ë¥ 
- ì²´ì¤‘: {progress['current_weight']}kg â†’ {progress['target_weight']}kg
- ì§„í–‰ë¥ : {progress['percentage']}%
- ë‚¨ì€ ê¸°ê°„: {progress['days_left']}ì¼

### ì˜¤ëŠ˜ í˜„í™©
- ì„­ì·¨ ì¹¼ë¡œë¦¬: {user_data['today_intake']}kcal / {user_data['daily_goal']}kcal
- ì†Œëª¨ ì¹¼ë¡œë¦¬: {user_data['today_burned']}kcal
- ë‚¨ì€ ì¹¼ë¡œë¦¬: {user_data['remaining']}kcal
"""
    
    return SYSTEM_PROMPT + context
```

---

## ğŸ¨ ì˜ë„ ë¶„ë¥˜ (Intent Classification)

### ì£¼ìš” ì˜ë„ ì¹´í…Œê³ ë¦¬

```python
INTENTS = {
    # ì¸ì‚¬
    'greeting': ['ì•ˆë…•', 'í•˜ì´', 'hi', 'hello', 'ì•ˆë…•í•˜ì„¸ìš”'],
    
    # ì‹ë‹¨ ê´€ë ¨
    'add_meal': ['ë¨¹ì—ˆì–´', 'ë¨¹ìŒ', 'ì¶”ê°€', 'ê¸°ë¡', 'ì…ë ¥'],
    'recommend_meal': ['ë­ ë¨¹ì„ê¹Œ', 'ì¶”ì²œ', 'ë©”ë‰´', 'ì‹ë‹¨'],
    'calorie_query': ['ì¹¼ë¡œë¦¬', 'ì˜ì–‘', 'ì˜ì–‘ì†Œ'],
    
    # ìš´ë™ ê´€ë ¨
    'add_exercise': ['ìš´ë™í–ˆì–´', 'ìš´ë™í•¨', 'ë‹¬ë ¸ì–´'],
    'recommend_exercise': ['ìš´ë™ ì¶”ì²œ', 'ì–´ë–¤ ìš´ë™', 'ìš´ë™ ë­í• ê¹Œ'],
    
    # ì •ë³´ ì¡°íšŒ
    'check_progress': ['ì§„í–‰ë¥ ', 'ì–¼ë§ˆë‚˜', 'ëª©í‘œ', 'ì§„ì²™'],
    'today_summary': ['ì˜¤ëŠ˜', 'í˜„í™©', 'ìš”ì•½'],
    'statistics': ['í†µê³„', 'ë¶„ì„', 'ê·¸ë˜í”„'],
    
    # ë„ì›€ë§
    'help': ['ë„ì›€', 'help', 'ë­ í•  ìˆ˜ ìˆì–´', 'ê¸°ëŠ¥'],
    
    # ê¸°íƒ€
    'water_reminder': ['ë¬¼', 'ìˆ˜ë¶„'],
    'motivation': ['í˜ë“¤ì–´', 'í¬ê¸°', 'ì–´ë ¤ì›Œ'],
}
```

### ì˜ë„ ë¶„ë¥˜ í•¨ìˆ˜

```python
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.naive_bayes import MultinomialNB
import re

class IntentClassifier:
    def __init__(self):
        self.vectorizer = TfidfVectorizer()
        self.classifier = MultinomialNB()
        self.trained = False
    
    def train(self, training_data):
        """
        training_data: [
            ("ì•ˆë…•í•˜ì„¸ìš”", "greeting"),
            ("ì˜¤ëŠ˜ ì ì‹¬ ë­ ë¨¹ì„ê¹Œ?", "recommend_meal"),
            ...
        ]
        """
        texts, labels = zip(*training_data)
        X = self.vectorizer.fit_transform(texts)
        self.classifier.fit(X, labels)
        self.trained = True
    
    def classify(self, text):
        """í…ìŠ¤íŠ¸ì˜ ì˜ë„ ë¶„ë¥˜"""
        if not self.trained:
            return self.rule_based_classify(text)
        
        X = self.vectorizer.transform([text])
        intent = self.classifier.predict(X)[0]
        confidence = max(self.classifier.predict_proba(X)[0])
        
        # ì‹ ë¢°ë„ê°€ ë‚®ìœ¼ë©´ ê·œì¹™ ê¸°ë°˜ìœ¼ë¡œ ì¬ë¶„ë¥˜
        if confidence < 0.6:
            return self.rule_based_classify(text)
        
        return intent
    
    def rule_based_classify(self, text):
        """ê·œì¹™ ê¸°ë°˜ ì˜ë„ ë¶„ë¥˜ (ë°±ì—…)"""
        text = text.lower()
        
        for intent, keywords in INTENTS.items():
            if any(keyword in text for keyword in keywords):
                return intent
        
        return 'general_question'
    
    def extract_entities(self, text, intent):
        """ì˜ë„ì— ë”°ë¼ ì—”í‹°í‹° ì¶”ì¶œ"""
        entities = {}
        
        if intent == 'add_meal':
            # ìŒì‹ëª… ì¶”ì¶œ
            food_match = re.search(r'([ê°€-í£]+)\s*(ë¨¹ì—ˆ|ë¨¹ìŒ|ì¶”ê°€)', text)
            if food_match:
                entities['food_name'] = food_match.group(1)
            
            # ì¹¼ë¡œë¦¬ ì¶”ì¶œ
            calorie_match = re.search(r'(\d+)\s*kcal', text)
            if calorie_match:
                entities['calories'] = int(calorie_match.group(1))
        
        elif intent == 'add_exercise':
            # ìš´ë™ëª… ì¶”ì¶œ
            exercise_match = re.search(r'([ê°€-í£]+)\s*(\d+)ë¶„', text)
            if exercise_match:
                entities['exercise_name'] = exercise_match.group(1)
                entities['duration'] = int(exercise_match.group(2))
        
        return entities
```

---

## âš™ï¸ ì±—ë´‡ ë§¤ë‹ˆì € êµ¬í˜„

### ë©”ì¸ ì±—ë´‡ í´ë˜ìŠ¤

```python
import json
from datetime import datetime

class HealthChatbot:
    def __init__(self, user_id, ai_engine='gpt-4'):
        self.user_id = user_id
        self.ai_engine = ai_engine
        self.intent_classifier = IntentClassifier()
        self.conversation_history = []
        
        # AI í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
        if ai_engine == 'gpt-4':
            import openai
            self.ai_client = openai
        elif ai_engine == 'gemini':
            import google.generativeai as genai
            self.ai_client = genai
    
    def process_message(self, user_message):
        """ì‚¬ìš©ì ë©”ì‹œì§€ ì²˜ë¦¬ ë° ì‘ë‹µ ìƒì„±"""
        
        # 1. ì˜ë„ ë¶„ë¥˜
        intent = self.intent_classifier.classify(user_message)
        entities = self.intent_classifier.extract_entities(user_message, intent)
        
        # 2. ì˜ë„ë³„ ì²˜ë¦¬
        response = self.handle_intent(intent, user_message, entities)
        
        # 3. ëŒ€í™” ê¸°ë¡ ì €ì¥
        self.save_conversation(user_message, response)
        
        return response
    
    def handle_intent(self, intent, message, entities):
        """ì˜ë„ë³„ í•¸ë“¤ëŸ¬"""
        
        handlers = {
            'greeting': self.handle_greeting,
            'add_meal': self.handle_add_meal,
            'add_exercise': self.handle_add_exercise,
            'recommend_meal': self.handle_recommend_meal,
            'recommend_exercise': self.handle_recommend_exercise,
            'check_progress': self.handle_check_progress,
            'today_summary': self.handle_today_summary,
            'help': self.handle_help,
            'water_reminder': self.handle_water_reminder,
            'motivation': self.handle_motivation,
        }
        
        handler = handlers.get(intent, self.handle_general_question)
        return handler(message, entities)
    
    def handle_greeting(self, message, entities):
        """ì¸ì‚¬ ì‘ë‹µ"""
        greetings = [
            "ì•ˆë…•í•˜ì„¸ìš”! ì˜¤ëŠ˜ë„ ê±´ê°•í•œ í•˜ë£¨ ë³´ë‚´ê³  ê³„ì‹ ê°€ìš”? ğŸ˜Š",
            "ë°˜ê°‘ìŠµë‹ˆë‹¤! ê±´ê°• ê´€ë¦¬ë¥¼ ë„ì™€ë“œë¦´ê²Œìš”!",
            "ì•ˆë…•í•˜ì„¸ìš”! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?"
        ]
        return random.choice(greetings)
    
    def handle_add_meal(self, message, entities):
        """ì‹ì‚¬ ê¸°ë¡ ì¶”ê°€"""
        if 'food_name' not in entities:
            return {
                "message": "ì–´ë–¤ ìŒì‹ì„ ë“œì…¨ë‚˜ìš”? ìŒì‹ ì´ë¦„ì„ ì•Œë ¤ì£¼ì„¸ìš”!",
                "action": None
            }
        
        food_name = entities['food_name']
        
        # ìŒì‹ DBì—ì„œ ì¹¼ë¡œë¦¬ ì¡°íšŒ
        food_info = self.get_food_info(food_name)
        
        if not food_info:
            return {
                "message": f"'{food_name}'ì˜ ì˜ì–‘ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ì–´ìš”. ì¹¼ë¡œë¦¬ë¥¼ ì§ì ‘ ì…ë ¥í•´ì£¼ì‹œê² ì–´ìš”?",
                "action": None
            }
        
        # ì‹ë‹¨ ê¸°ë¡ ì¶”ê°€
        meal_data = {
            "food_name": food_name,
            "calories": food_info['calories'],
            "meal_type": self.get_current_meal_type(),
            "date": datetime.now().strftime("%Y-%m-%d")
        }
        
        self.add_meal_to_db(meal_data)
        
        return {
            "message": f"âœ… {food_name} ({food_info['calories']}kcal) ê¸°ë¡í–ˆì–´ìš”!\n"
                      f"ì˜¤ëŠ˜ ì´ ì„­ì·¨: {self.get_today_calories()}kcal",
            "action": "meal_added",
            "data": meal_data
        }
    
    def handle_add_exercise(self, message, entities):
        """ìš´ë™ ê¸°ë¡ ì¶”ê°€"""
        if 'exercise_name' not in entities:
            return {
                "message": "ì–´ë–¤ ìš´ë™ì„ í•˜ì…¨ë‚˜ìš”?",
                "action": None
            }
        
        exercise_name = entities['exercise_name']
        duration = entities.get('duration', 30)  # ê¸°ë³¸ 30ë¶„
        
        # ìš´ë™ DBì—ì„œ ì¹¼ë¡œë¦¬ ì¡°íšŒ
        exercise_info = self.get_exercise_info(exercise_name)
        calories_burned = exercise_info['calories_per_min'] * duration
        
        # ìš´ë™ ê¸°ë¡ ì¶”ê°€
        exercise_data = {
            "exercise_name": exercise_name,
            "duration": duration,
            "calories_burned": calories_burned,
            "date": datetime.now().strftime("%Y-%m-%d")
        }
        
        self.add_exercise_to_db(exercise_data)
        
        return {
            "message": f"ğŸ’ª {exercise_name} {duration}ë¶„ ({calories_burned}kcal ì†Œëª¨) ê¸°ë¡í–ˆì–´ìš”!\n"
                      f"ì˜¤ëŠ˜ ì—´ì‹¬íˆ í•˜ì…¨ë„¤ìš”! ğŸ‘",
            "action": "exercise_added",
            "data": exercise_data
        }
    
    def handle_recommend_meal(self, message, entities):
        """ì‹ë‹¨ ì¶”ì²œ"""
        # í˜„ì¬ ì„­ì·¨ ì¹¼ë¡œë¦¬ í™•ì¸
        current_intake = self.get_today_calories()
        daily_goal = self.get_daily_calorie_goal()
        remaining = daily_goal - current_intake
        
        # í˜„ì¬ ì‹œê°„ëŒ€ì— ë§ëŠ” ì‹ì‚¬ íƒ€ì…
        meal_type = self.get_current_meal_type()
        
        # AI ê¸°ë°˜ ì¶”ì²œ ìƒì„±
        context = f"""
        ì‚¬ìš©ìê°€ {meal_type} ë©”ë‰´ë¥¼ ì¶”ì²œë°›ê³  ì‹¶ì–´í•©ë‹ˆë‹¤.
        - ë‚¨ì€ ì¹¼ë¡œë¦¬: {remaining}kcal
        - í˜„ì¬ ê³„ì ˆ: {self.get_current_season()}
        - ëª©í‘œ: ê±´ê°•í•œ ë‹¤ì´ì–´íŠ¸
        
        ì ì ˆí•œ ë©”ë‰´ë¥¼ ì¶”ì²œí•´ì£¼ì„¸ìš”.
        """
        
        ai_response = self.get_ai_recommendation(context)
        
        return {
            "message": ai_response,
            "action": "meal_recommended"
        }
    
    def handle_recommend_exercise(self, message, entities):
        """ìš´ë™ ì¶”ì²œ"""
        # ë‚ ì”¨ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        weather = self.get_weather_info()
        
        # ì‚¬ìš©ì ìš´ë™ ì´ë ¥ ë¶„ì„
        exercise_history = self.get_exercise_history(days=7)
        
        # AI ê¸°ë°˜ ì¶”ì²œ
        context = f"""
        ì‚¬ìš©ìì—ê²Œ ìš´ë™ì„ ì¶”ì²œí•´ì£¼ì„¸ìš”.
        - ë‚ ì”¨: {weather['condition']}, ì˜¨ë„: {weather['temp']}Â°C
        - ìµœê·¼ 7ì¼ ìš´ë™: {exercise_history}
        - ëª©í‘œ: ê±´ê°•í•œ ë‹¤ì´ì–´íŠ¸
        
        ì‹¤ë‚´/ì‹¤ì™¸ ìš´ë™ì„ ëª¨ë‘ ì¶”ì²œí•´ì£¼ì„¸ìš”.
        """
        
        ai_response = self.get_ai_recommendation(context)
        
        return {
            "message": ai_response,
            "action": "exercise_recommended"
        }
    
    def handle_check_progress(self, message, entities):
        """ëª©í‘œ ì§„í–‰ ìƒí™© í™•ì¸"""
        progress = self.get_progress_data()
        
        message = f"""
ğŸ“Š ëª©í‘œ ì§„í–‰ ìƒí™©

âš–ï¸ ì²´ì¤‘
- ì‹œì‘: {progress['start_weight']}kg
- í˜„ì¬: {progress['current_weight']}kg
- ëª©í‘œ: {progress['target_weight']}kg
- ê°ëŸ‰: {progress['weight_lost']}kg

ğŸ“ˆ ì§„í–‰ë¥ : {progress['percentage']}%
ğŸ“… ë‚¨ì€ ê¸°ê°„: {progress['days_left']}ì¼

{self.get_motivational_message(progress['percentage'])}
"""
        
        return {
            "message": message,
            "action": "show_progress",
            "data": progress
        }
    
    def handle_today_summary(self, message, entities):
        """ì˜¤ëŠ˜ ìš”ì•½"""
        summary = self.get_today_summary()
        
        message = f"""
ğŸ“‹ ì˜¤ëŠ˜ì˜ ìš”ì•½

ğŸ½ï¸ ì‹ë‹¨
- ì„­ì·¨ ì¹¼ë¡œë¦¬: {summary['calories_intake']} / {summary['daily_goal']}kcal
- ë‚¨ì€ ì¹¼ë¡œë¦¬: {summary['remaining']}kcal

ğŸ’ª ìš´ë™
- ìš´ë™ ì‹œê°„: {summary['exercise_minutes']}ë¶„
- ì†Œëª¨ ì¹¼ë¡œë¦¬: {summary['calories_burned']}kcal

ğŸ’§ ìˆ˜ë¶„
- ì„­ì·¨ëŸ‰: {summary['water_intake']}ml / {summary['water_goal']}ml

{self.get_daily_tip()}
"""
        
        return {
            "message": message,
            "action": "show_summary",
            "data": summary
        }
    
    def handle_help(self, message, entities):
        """ë„ì›€ë§"""
        return {
            "message": """
ğŸ¤– AI ì–´ì‹œìŠ¤í„´íŠ¸ ë„ì›€ë§

ì œê°€ ë„ì™€ë“œë¦´ ìˆ˜ ìˆëŠ” ê²ƒë“¤:

ğŸ“ ê¸°ë¡
- "ì ì‹¬ìœ¼ë¡œ ìƒëŸ¬ë“œ ë¨¹ì—ˆì–´"
- "ëŸ¬ë‹ 30ë¶„ í–ˆì–´"

ğŸ’¡ ì¶”ì²œ
- "ì˜¤ëŠ˜ ì €ë… ë­ ë¨¹ì„ê¹Œ?"
- "ìš´ë™ ì¶”ì²œí•´ì¤˜"

ğŸ“Š ì¡°íšŒ
- "ëª©í‘œ ì§„í–‰ë¥  ë³´ì—¬ì¤˜"
- "ì˜¤ëŠ˜ í˜„í™© ì•Œë ¤ì¤˜"

ğŸ’§ ê¸°íƒ€
- "ë¬¼ ë§ˆì‹œê¸° ì•Œë ¤ì¤˜"
- "ì¹¼ë¡œë¦¬ ê³„ì‚°í•´ì¤˜"

ë¬´ì—‡ì´ë“  í¸í•˜ê²Œ ë¬¼ì–´ë³´ì„¸ìš”! ğŸ˜Š
""",
            "action": None
        }
    
    def handle_general_question(self, message, entities):
        """ì¼ë°˜ ì§ˆë¬¸ - AI ì‘ë‹µ"""
        # ì‚¬ìš©ì ì»¨í…ìŠ¤íŠ¸ ìƒì„±
        context_prompt = create_context_prompt(self.get_user_data())
        
        # AI ì‘ë‹µ ìƒì„±
        full_prompt = f"{context_prompt}\n\nì‚¬ìš©ì ì§ˆë¬¸: {message}"
        ai_response = self.get_ai_response(full_prompt)
        
        return {
            "message": ai_response,
            "action": None
        }
    
    # í—¬í¼ ë©”ì„œë“œë“¤
    def get_ai_response(self, prompt):
        """AI ì‘ë‹µ ìƒì„±"""
        if self.ai_engine == 'gpt-4':
            response = self.ai_client.ChatCompletion.create(
                model="gpt-4",
                messages=[
                    {"role": "system", "content": SYSTEM_PROMPT},
                    {"role": "user", "content": prompt}
                ],
                temperature=0.7,
                max_tokens=500
            )
            return response.choices[0].message.content
        # ë‹¤ë¥¸ ì—”ì§„ë“¤ë„ ìœ ì‚¬í•˜ê²Œ êµ¬í˜„
    
    def save_conversation(self, user_msg, bot_response):
        """ëŒ€í™” ê¸°ë¡ ì €ì¥"""
        self.conversation_history.append({
            "timestamp": datetime.now(),
            "user": user_msg,
            "bot": bot_response.get('message', bot_response) if isinstance(bot_response, dict) else bot_response
        })
        
        # DBì— ì €ì¥
        # save_to_db(self.user_id, self.conversation_history[-1])
```

---

## ğŸ¨ GUI í†µí•© ì½”ë“œ

### PyQt5 ì±„íŒ… ìœ„ì ¯

```python
from PyQt5.QtWidgets import *
from PyQt5.QtCore import *
from PyQt5.QtGui import *

class ChatWidget(QWidget):
    def __init__(self, chatbot):
        super().__init__()
        self.chatbot = chatbot
        self.init_ui()
    
    def init_ui(self):
        layout = QVBoxLayout()
        
        # ì±„íŒ… íˆìŠ¤í† ë¦¬ ì˜ì—­
        self.chat_history = QTextEdit()
        self.chat_history.setReadOnly(True)
        self.chat_history.setStyleSheet("""
            QTextEdit {
                background-color: #f5f5f5;
                border: none;
                padding: 10px;
                font-size: 14px;
            }
        """)
        
        # ì…ë ¥ ì˜ì—­
        input_layout = QHBoxLayout()
        
        self.message_input = QLineEdit()
        self.message_input.setPlaceholderText("ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”...")
        self.message_input.returnPressed.connect(self.send_message)
        self.message_input.setStyleSheet("""
            QLineEdit {
                border: 2px solid #ddd;
                border-radius: 20px;
                padding: 10px 15px;
                font-size: 14px;
            }
        """)
        
        self.send_button = QPushButton("ì „ì†¡")
        self.send_button.clicked.connect(self.send_message)
        self.send_button.setStyleSheet("""
            QPushButton {
                background-color: #4CAF50;
                color: white;
                border: none;
                border-radius: 20px;
                padding: 10px 20px;
                font-size: 14px;
            }
            QPushButton:hover {
                background-color: #45a049;
            }
        """)
        
        input_layout.addWidget(self.message_input)
        input_layout.addWidget(self.send_button)
        
        # ë¹ ë¥¸ ì§ˆë¬¸ ë²„íŠ¼
        quick_questions_layout = QHBoxLayout()
        quick_questions = [
            "ì˜¤ëŠ˜ ë­ ë¨¹ì„ê¹Œ?",
            "ìš´ë™ ì¶”ì²œí•´ì¤˜",
            "ëª©í‘œ ì§„í–‰ë¥ ì€?",
            "ë¬¼ ë§ˆì‹œê¸° ì•Œë ¤ì¤˜"
        ]
        
        for question in quick_questions:
            btn = QPushButton(question)
            btn.clicked.connect(lambda checked, q=question: self.send_quick_question(q))
            btn.setStyleSheet("""
                QPushButton {
                    background-color: #e0e0e0;
                    border: none;
                    border-radius: 15px;
                    padding: 8px 12px;
                    font-size: 12px;
                }
                QPushButton:hover {
                    background-color: #d0d0d0;
                }
            """)
            quick_questions_layout.addWidget(btn)
        
        layout.addWidget(QLabel("ğŸ’¬ AI ì–´ì‹œìŠ¤í„´íŠ¸"))
        layout.addWidget(self.chat_history)
        layout.addLayout(input_layout)
        layout.addLayout(quick_questions_layout)
        
        self.setLayout(layout)
        
        # í™˜ì˜ ë©”ì‹œì§€
        self.add_bot_message("ì•ˆë…•í•˜ì„¸ìš”! ê±´ê°• ê´€ë¦¬ë¥¼ ë„ì™€ë“œë¦´ AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤. ğŸ˜Š")
    
    def send_message(self):
        """ë©”ì‹œì§€ ì „ì†¡"""
        message = self.message_input.text().strip()
        if not message:
            return
        
        # ì‚¬ìš©ì ë©”ì‹œì§€ í‘œì‹œ
        self.add_user_message(message)
        self.message_input.clear()
        
        # ë¡œë”© í‘œì‹œ
        self.add_bot_message("ğŸ’­ ìƒê°í•˜ëŠ” ì¤‘...")
        
        # AI ì‘ë‹µ ìƒì„± (ë³„ë„ ìŠ¤ë ˆë“œì—ì„œ)
        self.worker = ResponseWorker(self.chatbot, message)
        self.worker.response_ready.connect(self.handle_response)
        self.worker.start()
    
    def send_quick_question(self, question):
        """ë¹ ë¥¸ ì§ˆë¬¸ ì „ì†¡"""
        self.message_input.setText(question)
        self.send_message()
    
    def handle_response(self, response):
        """AI ì‘ë‹µ ì²˜ë¦¬"""
        # ë¡œë”© ë©”ì‹œì§€ ì œê±°
        cursor = self.chat_history.textCursor()
        cursor.movePosition(QTextCursor.End)
        cursor.movePosition(QTextCursor.StartOfBlock, QTextCursor.KeepAnchor)
        cursor.movePosition(QTextCursor.Up, QTextCursor.KeepAnchor)
        cursor.removeSelectedText()
        
        # ì‹¤ì œ ì‘ë‹µ í‘œì‹œ
        if isinstance(response, dict):
            self.add_bot_message(response['message'])
            
            # ì•¡ì…˜ ì²˜ë¦¬
            if response.get('action'):
                self.handle_action(response['action'], response.get('data'))
        else:
            self.add_bot_message(response)
    
    def add_user_message(self, message):
        """ì‚¬ìš©ì ë©”ì‹œì§€ ì¶”ê°€"""
        self.chat_history.append(f'<div style="text-align: right; margin: 10px;">'
                                 f'<span style="background-color: #4CAF50; color: white; '
                                 f'padding: 8px 12px; border-radius: 15px; display: inline-block;">'
                                 f'{message}</span></div>')
    
    def add_bot_message(self, message):
        """ë´‡ ë©”ì‹œì§€ ì¶”ê°€"""
        self.chat_history.append(f'<div style="text-align: left; margin: 10px;">'
                                 f'<span style="background-color: #e0e0e0; color: black; '
                                 f'padding: 8px 12px; border-radius: 15px; display: inline-block;">'
                                 f'ğŸ¤– {message}</span></div>')
    
    def handle_action(self, action, data):
        """ì•¡ì…˜ ì²˜ë¦¬"""
        if action == 'meal_added':
            # ì‹ë‹¨ íƒ­ìœ¼ë¡œ ì „í™˜ ë˜ëŠ” ì—…ë°ì´íŠ¸
            pass
        elif action == 'exercise_added':
            # ìš´ë™ íƒ­ìœ¼ë¡œ ì „í™˜ ë˜ëŠ” ì—…ë°ì´íŠ¸
            pass
        elif action == 'show_progress':
            # ì§„í–‰ë¥  ì°¨íŠ¸ í‘œì‹œ
            pass


class ResponseWorker(QThread):
    """AI ì‘ë‹µ ìƒì„± ì›Œì»¤ ìŠ¤ë ˆë“œ"""
    response_ready = pyqtSignal(object)
    
    def __init__(self, chatbot, message):
        super().__init__()
        self.chatbot = chatbot
        self.message = message
    
    def run(self):
        """ë°±ê·¸ë¼ìš´ë“œì—ì„œ AI ì‘ë‹µ ìƒì„±"""
        response = self.chatbot.process_message(self.message)
        self.response_ready.emit(response)
```

---

## ğŸš€ ê³ ê¸‰ ê¸°ëŠ¥

### 1. ìŒì„± ì¸ì‹ í†µí•©

```python
import speech_recognition as sr

class VoiceChatbot:
    def __init__(self, chatbot):
        self.chatbot = chatbot
        self.recognizer = sr.Recognizer()
    
    def listen(self):
        """ìŒì„± ì…ë ¥ ë“£ê¸°"""
        with sr.Microphone() as source:
            print("ğŸ¤ ë“£ëŠ” ì¤‘...")
            audio = self.recognizer.listen(source)
        
        try:
            text = self.recognizer.recognize_google(audio, language='ko-KR')
            print(f"ì¸ì‹ëœ í…ìŠ¤íŠ¸: {text}")
            return text
        except sr.UnknownValueError:
            return None
        except sr.RequestError:
            return None
    
    def speak(self, text):
        """í…ìŠ¤íŠ¸ë¥¼ ìŒì„±ìœ¼ë¡œ ë³€í™˜"""
        from gtts import gTTS
        import pygame
        
        tts = gTTS(text=text, lang='ko')
        tts.save("response.mp3")
        
        pygame.mixer.init()
        pygame.mixer.music.load("response.mp3")
        pygame.mixer.music.play()
```

### 2. ì»¨í…ìŠ¤íŠ¸ ë©”ëª¨ë¦¬

```python
class ConversationMemory:
    def __init__(self, max_history=10):
        self.history = []
        self.max_history = max_history
        self.context = {}
    
    def add_turn(self, user_msg, bot_response):
        """ëŒ€í™” í„´ ì¶”ê°€"""
        self.history.append({
            'user': user_msg,
            'bot': bot_response,
            'timestamp': datetime.now()
        })
        
        # ìµœëŒ€ íˆìŠ¤í† ë¦¬ ìœ ì§€
        if len(self.history) > self.max_history:
            self.history.pop(0)
    
    def get_context(self):
        """ëŒ€í™” ì»¨í…ìŠ¤íŠ¸ ìƒì„±"""
        context = "## ìµœê·¼ ëŒ€í™” ê¸°ë¡\n"
        for turn in self.history[-5:]:  # ìµœê·¼ 5í„´
            context += f"ì‚¬ìš©ì: {turn['user']}\n"
            context += f"ì–´ì‹œìŠ¤í„´íŠ¸: {turn['bot']}\n"
        return context
    
    def update_context(self, key, value):
        """ì»¨í…ìŠ¤íŠ¸ ì •ë³´ ì—…ë°ì´íŠ¸"""
        self.context[key] = value
```

### 3. ê°ì • ë¶„ì„

```python
from textblob import TextBlob

def analyze_sentiment(text):
    """ì‚¬ìš©ì ë©”ì‹œì§€ì˜ ê°ì • ë¶„ì„"""
    blob = TextBlob(text)
    polarity = blob.sentiment.polarity
    
    if polarity > 0.3:
        return 'positive'
    elif polarity < -0.3:
        return 'negative'
    else:
        return 'neutral'

def adjust_tone(sentiment):
    """ê°ì •ì— ë”°ë¥¸ í†¤ ì¡°ì ˆ"""
    if sentiment == 'negative':
        return "ì €ë„ í•¨ê»˜ ì‘ì›í•˜ê³  ìˆì–´ìš”! ğŸ’ª í˜ë‚´ì„¸ìš”!"
    elif sentiment == 'positive':
        return "ì •ë§ ì˜í•˜ê³  ê³„ì‹œë„¤ìš”! ğŸ‘ ê³„ì† í™”ì´íŒ…!"
    else:
        return ""
```

---

## ğŸ“Š ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

### ë©”íŠ¸ë¦­ ìˆ˜ì§‘

```python
import time
from collections import defaultdict

class ChatbotMetrics:
    def __init__(self):
        self.metrics = defaultdict(list)
    
    def log_response_time(self, duration):
        """ì‘ë‹µ ì‹œê°„ ê¸°ë¡"""
        self.metrics['response_time'].append(duration)
    
    def log_intent_accuracy(self, predicted, actual):
        """ì˜ë„ ë¶„ë¥˜ ì •í™•ë„ ê¸°ë¡"""
        correct = predicted == actual
        self.metrics['intent_accuracy'].append(correct)
    
    def log_user_satisfaction(self, rating):
        """ì‚¬ìš©ì ë§Œì¡±ë„ ê¸°ë¡"""
        self.metrics['satisfaction'].append(rating)
    
    def get_stats(self):
        """í†µê³„ ì¡°íšŒ"""
        return {
            'avg_response_time': sum(self.metrics['response_time']) / len(self.metrics['response_time']),
            'intent_accuracy': sum(self.metrics['intent_accuracy']) / len(self.metrics['intent_accuracy']),
            'avg_satisfaction': sum(self.metrics['satisfaction']) / len(self.metrics['satisfaction'])
        }
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

```python
import unittest

class TestChatbot(unittest.TestCase):
    def setUp(self):
        self.chatbot = HealthChatbot(user_id=1)
    
    def test_greeting(self):
        response = self.chatbot.process_message("ì•ˆë…•í•˜ì„¸ìš”")
        self.assertIn("ì•ˆë…•", response['message'])
    
    def test_add_meal(self):
        response = self.chatbot.process_message("ì ì‹¬ìœ¼ë¡œ ìƒëŸ¬ë“œ ë¨¹ì—ˆì–´")
        self.assertEqual(response['action'], 'meal_added')
        self.assertIn('ìƒëŸ¬ë“œ', response['data']['food_name'])
    
    def test_recommend_meal(self):
        response = self.chatbot.process_message("ì €ë… ë­ ë¨¹ì„ê¹Œ?")
        self.assertIn('ì¶”ì²œ', response['message'].lower())
    
    def test_check_progress(self):
        response = self.chatbot.process_message("ëª©í‘œ ì§„í–‰ë¥  ë³´ì—¬ì¤˜")
        self.assertEqual(response['action'], 'show_progress')

if __name__ == '__main__':
    unittest.main()
```

---

## ğŸ” ë³´ì•ˆ ë° í”„ë¼ì´ë²„ì‹œ

### 1. ë°ì´í„° ë³´í˜¸
- API í‚¤ëŠ” í™˜ê²½ ë³€ìˆ˜ë¡œ ê´€ë¦¬
- ë¯¼ê°í•œ ê±´ê°• ì •ë³´ëŠ” ë¡œì»¬ DBì—ë§Œ ì €ì¥
- AI ìš”ì²­ ì‹œ ê°œì¸ ì‹ë³„ ì •ë³´ ì œê±°

### 2. ì…ë ¥ ê²€ì¦
```python
def sanitize_input(text):
    """ì‚¬ìš©ì ì…ë ¥ ê²€ì¦"""
    # SQL ì¸ì ì…˜ ë°©ì§€
    text = text.replace("'", "''")
    
    # XSS ë°©ì§€
    text = text.replace("<", "&lt;").replace(">", "&gt;")
    
    # ìµœëŒ€ ê¸¸ì´ ì œí•œ
    if len(text) > 500:
        text = text[:500]
    
    return text
```

---

## ğŸ“ˆ ê°œì„  ë¡œë“œë§µ

### Phase 1 (MVP) - 2ì£¼
- [x] ê¸°ë³¸ ì˜ë„ ë¶„ë¥˜
- [x] ê·œì¹™ ê¸°ë°˜ ì‘ë‹µ
- [x] ê°„ë‹¨í•œ GUI í†µí•©

### Phase 2 - 2ì£¼
- [ ] AI API í†µí•© (GPT/Gemini)
- [ ] ì»¨í…ìŠ¤íŠ¸ ë©”ëª¨ë¦¬
- [ ] ë°ì´í„° ê¸°ë°˜ ì¶”ì²œ

### Phase 3 - 2ì£¼
- [ ] ìŒì„± ì¸ì‹/TTS
- [ ] ê°ì • ë¶„ì„
- [ ] ê³ ê¸‰ ê°œì¸í™”

### Phase 4 - ì§€ì†ì 
- [ ] ëª¨ë¸ íŒŒì¸íŠœë‹
- [ ] A/B í…ŒìŠ¤íŒ…
- [ ] ì‚¬ìš©ì í”¼ë“œë°± ë°˜ì˜

---

## ğŸ’¡ ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤

1. **ì ì§„ì  ê°œì„ **: ê°„ë‹¨í•œ ê·œì¹™ ê¸°ë°˜ìœ¼ë¡œ ì‹œì‘í•´ì„œ AIë¥¼ ì ì§„ì ìœ¼ë¡œ ë„ì…
2. **ì‚¬ìš©ì í”¼ë“œë°±**: ì‘ë‹µì— ğŸ‘/ğŸ‘ ë²„íŠ¼ ì¶”ê°€í•´ì„œ ì§€ì†ì ìœ¼ë¡œ ê°œì„ 
3. **í´ë°± ì²˜ë¦¬**: AIê°€ ì´í•´ ëª»í•˜ë©´ ëª…í™•í•œ ì•ˆë‚´ ë©”ì‹œì§€ ì œê³µ
4. **ì„±ëŠ¥ ìµœì í™”**: ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ì€ ìºì‹±
5. **ìœ¤ë¦¬ì  ê³ ë ¤**: ì˜í•™ì  ì§„ë‹¨/ì²˜ë°©ì€ í•˜ì§€ ì•Šê³  ì „ë¬¸ì˜ ìƒë‹´ ê¶Œìœ 

